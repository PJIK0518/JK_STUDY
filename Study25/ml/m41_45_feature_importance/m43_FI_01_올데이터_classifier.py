from sklearn.datasets import load_breast_cancer, load_wine, load_digits
from sklearn.tree import DecisionTreeClassifier, DecisionTreeRegressor
from sklearn.ensemble import RandomForestClassifier, RandomForestRegressor, GradientBoostingClassifier, GradientBoostingRegressor
from xgboost import XGBClassifier, XGBRFRegressor
from sklearn.preprocessing import MinMaxScaler, StandardScaler
from xgboost import XGBClassifier
import random
import numpy as np

from sklearn.model_selection import train_test_split

seed = 25
random.seed(seed)
np.random.seed(seed)

#1. 데이터
DS1 = load_breast_cancer()
DS2 = load_wine()
DS3 = load_digits()

DSL = [DS1, DS2, DS3]
DS_name = ['cancer','wine','digits']

model1 = DecisionTreeRegressor(random_state=seed)
model2 = RandomForestRegressor(random_state=seed)
model3 = GradientBoostingRegressor(random_state=seed)
model4 = XGBRFRegressor(random_state=seed)
models = [model1,model2,model3,model4]

for i, DS in enumerate(DSL):
    x = DS.data
    y = DS.target
    
    x_trn, x_tst, y_trn, y_tst = train_test_split(
        x, y,
        train_size=0.85,
        shuffle=True,
        random_state=777
    )
    
    SCL = StandardScaler()
    x_trn = SCL.fit_transform(x_trn)
    x_tst = SCL.transform(x_tst)
    
    print('ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ',DS_name[i],'ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ')
    for model in models:
        model.fit(x_trn, y_trn)
        print('ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ', model.__class__.__name__,'ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ')
        print('acc :', model.score(x_tst, y_tst))
        print(model.feature_importances_)

# ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ cancer ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ
# ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ DecisionTreeRegressor ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ
# acc : 0.6293103448275863
# [0.         0.01053512 0.03259937 0.         0.         0.
#  0.         0.         0.         0.         0.00850472 0.02234722
#  0.00287121 0.01144702 0.00122226 0.         0.00850798 0.
#  0.         0.         0.01114291 0.01254181 0.         0.11638584
#  0.         0.         0.02778003 0.72826168 0.         0.00585284]
# ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ RandomForestRegressor ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ
# acc : 0.7684301724137932
# [0.00142275 0.01883257 0.0028314  0.00575374 0.00373632 0.00088063
#  0.00677737 0.1273593  0.0026235  0.0017569  0.00429128 0.00367179
#  0.00223924 0.01529521 0.00267506 0.00119068 0.00716979 0.00252014
#  0.00187619 0.00509613 0.09683192 0.01492685 0.18332955 0.09410685
#  0.00711617 0.00147093 0.01415661 0.36383337 0.00316455 0.00306324]
# ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ GradientBoostingRegressor ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ
# acc : 0.750105104249942
# [1.86342409e-04 3.25097336e-02 7.14763399e-04 2.53251910e-03
#  6.29534550e-04 7.99185368e-04 1.35750919e-02 5.24310815e-02
#  7.95650303e-04 4.79194952e-04 3.69967267e-03 6.46827943e-04
#  2.01221247e-03 1.18876846e-02 2.22141637e-03 2.27975864e-03
#  8.28710574e-03 8.24889156e-04 5.43201042e-04 2.89030875e-03
#  3.52021385e-01 1.90155410e-02 6.11363255e-02 4.48598419e-02
#  4.63618957e-03 2.06870884e-04 1.59524196e-02 3.60337584e-01
#  1.85193997e-03 3.57286566e-05]
# ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ XGBRFRegressor ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ
# acc : 0.7311526536941528
# [0.00420878 0.01066547 0.01191612 0.01729296 0.00820507 0.00613952
#  0.01296025 0.11184835 0.0088389  0.00810683 0.00542416 0.00813836
#  0.00544702 0.00715396 0.00203429 0.01232727 0.01492602 0.01554878
#  0.00670914 0.00220725 0.25804287 0.01659833 0.16546378 0.07317368
#  0.01084469 0.01914009 0.01399125 0.14102414 0.00959258 0.01203012]
# ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ wine ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ
# ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ DecisionTreeRegressor ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ
# acc : 0.875
# [0.00347381 0.         0.         0.00739109 0.         0.
#  0.64063508 0.         0.         0.10528819 0.         0.
#  0.24321182]
# ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ RandomForestRegressor ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ
# acc : 0.89375625
# [0.04428365 0.00235984 0.00091789 0.0050876  0.00324286 0.0020303
#  0.53033392 0.00062059 0.00156982 0.06561722 0.01296856 0.05570306
#  0.27526469]
# ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ GradientBoostingRegressor ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ
# acc : 0.857336313014711
# [7.27853478e-03 8.59087091e-04 4.71683443e-05 3.47544813e-04
#  9.31728261e-04 1.15066951e-04 6.42045957e-01 2.51455765e-05
#  1.11758035e-05 1.05718027e-01 2.57312444e-03 3.54189367e-05
#  2.40012021e-01]
# ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ XGBRFRegressor ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ
# acc : 0.901068925857544
# [0.03731463 0.00878333 0.01026182 0.01162878 0.01687735 0.00706128
#  0.32567266 0.         0.         0.04338171 0.05863532 0.3468562
#  0.13352689]
# ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ digits ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ
# ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ DecisionTreeRegressor ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ
# acc : 0.627126750614883
# [0.00000000e+00 1.00678891e-02 2.22498224e-03 6.07406714e-04
#  2.85943463e-03 7.89605857e-03 1.29036379e-03 2.58446980e-03
#  0.00000000e+00 7.46743145e-04 4.10231156e-03 3.26785708e-03
#  1.40673538e-03 2.09552962e-02 4.97995619e-03 0.00000000e+00
#  0.00000000e+00 1.04616075e-02 9.44823051e-03 6.02546274e-03
#  1.05572044e-01 3.82457381e-02 1.50813287e-02 0.00000000e+00
#  0.00000000e+00 1.07371908e-02 7.37136621e-03 3.51844750e-02
#  8.92810255e-02 6.38169800e-02 1.63648039e-02 7.71325349e-04
#  0.00000000e+00 2.80668520e-02 1.28720216e-02 4.45624612e-02
#  9.54383401e-02 1.33081545e-04 1.12880894e-03 0.00000000e+00
#  0.00000000e+00 1.67866082e-03 3.20434668e-02 4.82350106e-03
#  3.72616477e-03 6.38956936e-03 2.29365669e-04 0.00000000e+00
#  0.00000000e+00 0.00000000e+00 7.41519010e-03 2.93264488e-02
#  1.27683939e-01 1.22479586e-02 3.11702859e-02 0.00000000e+00
#  0.00000000e+00 1.07505613e-04 2.81959662e-02 3.26741877e-03
#  2.13954170e-03 1.15693105e-02 7.96407883e-04 4.36366509e-02]
# ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ RandomForestRegressor ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ
# acc : 0.8629352143815299
# [0.00000000e+00 9.62253422e-04 9.38244580e-03 3.32148005e-03
#  4.97774104e-03 6.14254163e-03 3.68511177e-03 3.63121953e-04
#  1.17570860e-04 2.27367852e-03 1.06929991e-02 4.34487838e-03
#  2.01327214e-02 1.30705542e-02 2.45706320e-03 2.78590178e-04
#  2.38813651e-04 1.85627586e-03 2.60606090e-02 1.17211324e-02
#  8.99210752e-02 6.39802021e-02 7.07838258e-03 1.00797920e-04
#  1.08168802e-04 5.68030741e-03 1.92222854e-02 4.20436039e-02
#  7.43171310e-02 5.38926752e-02 1.64811577e-02 1.00660131e-04
#  0.00000000e+00 2.63577409e-02 2.10841358e-02 3.29018478e-02
#  8.89688569e-02 8.06722189e-03 7.10734935e-03 0.00000000e+00
#  1.40561758e-06 3.44495219e-03 2.43887171e-02 1.59824302e-02
#  7.88070641e-03 5.90441453e-03 6.14979874e-03 6.97529087e-05
#  2.10032749e-05 7.27975896e-04 6.95144762e-03 2.75450587e-02
#  1.17674666e-01 9.74430656e-03 8.05648520e-03 1.98532814e-04
#  0.00000000e+00 1.21971890e-03 6.35070745e-03 4.39629042e-03
#  1.12776846e-02 1.81284059e-02 2.73798261e-02 1.70125304e-02]
# ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ GradientBoostingRegressor ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ
# acc : 0.8145106385311496
# [0.00000000e+00 5.48020975e-05 1.83139664e-03 3.24518771e-03
#  1.54062394e-03 7.04753048e-03 3.72609976e-04 6.48112505e-04
#  0.00000000e+00 3.16136340e-03 1.23215864e-02 2.93921257e-03
#  2.68531639e-02 2.86060030e-03 2.60253989e-03 0.00000000e+00
#  4.67328707e-04 1.38411881e-03 2.87980426e-02 1.47871700e-02
#  8.53827241e-02 6.86741109e-02 8.03378297e-03 1.72531870e-05
#  4.16887391e-05 6.47031218e-03 1.27583933e-02 7.20843298e-02
#  6.03897761e-02 5.30451250e-02 2.44029291e-02 6.32484458e-04
#  0.00000000e+00 3.81925534e-02 1.06452088e-02 6.38008712e-02
#  9.00402600e-02 1.48199467e-02 5.57689278e-03 0.00000000e+00
#  0.00000000e+00 7.20131970e-04 2.67118324e-02 1.09324405e-02
#  6.35990917e-03 9.25858589e-03 1.46520652e-03 0.00000000e+00
#  0.00000000e+00 0.00000000e+00 2.50317433e-03 2.76121053e-02
#  1.21172410e-01 7.98578030e-03 2.01787426e-03 3.37357470e-04
#  0.00000000e+00 0.00000000e+00 3.46887377e-03 5.14963852e-03
#  6.60021775e-03 2.63686826e-02 6.58628322e-03 8.82546318e-03]
# ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ XGBRFRegressor ㅡㅡㅡㅡㅡㅡㅡㅡㅡㅡ
# acc : 0.7963854670524597
# [0.         0.00190168 0.00224186 0.00242081 0.00239768 0.00473591
#  0.00632519 0.00266355 0.00554568 0.00339203 0.01204815 0.00439325
#  0.01679228 0.00796823 0.00534831 0.         0.00319999 0.00375497
#  0.00932077 0.00725406 0.06451833 0.02059825 0.02083343 0.00084671
#  0.         0.00661265 0.01156655 0.02758041 0.04881446 0.04683852
#  0.02192764 0.00126842 0.         0.02674394 0.01889348 0.02438094
#  0.05322803 0.0089085  0.01257182 0.         0.         0.0076918
#  0.02749274 0.01468078 0.00947888 0.00842281 0.01175387 0.
#  0.         0.00313902 0.01441021 0.03103934 0.12827691 0.01211014
#  0.01961724 0.04212137 0.         0.00676734 0.01